abline(a=a,b=b,col="red")
abline(a=1.2*a,b=1.2*b,col="green")
dev.off()
plot(svmPredFin,outcomeFin,xlim=c(0,12000),ylim=c(0,12000),col="black",type="p",pch='.')
abline(a=0,b=1.2,col="yellow")
abline(lmfit,col="blue")
file<-"C:/Users/natasa/Documents/projectAmadeus/figures/exploratory/taxi/t_tripDistPredSVMfin2b.png"
file<-"C:/Users/natasa/Documents/projectAmadeus/figures/exploratory/taxi/t_tripDistPredSVMfin2b.png"
png(file)
plot(svmPredFin,outcomeFin,xlim=c(0,12000),ylim=c(0,12000),col="black",type="p",pch='.')
abline(a=0,b=1.2,col="red")
dev.off()
file<-"C:/Users/natasa/Documents/projectAmadeus/code/model/taxi/fits/tOct01svmDistCombined3.rdata"
load(file)
file<-"C:/Users/natasa/Documents/projectAmadeus/figures/exploratory/taxi/t_tripDistPredSVMfin3b.png"
png(file)
plot(svmPredFin,outcomeFin,xlim=c(0,12000),ylim=c(0,12000),col="black",type="p",pch='.')
abline(a=0,b=1.2,col="red")
dev.off()
file<-"C:/Users/natasa/Documents/projectAmadeus/code/model/taxi/fits/tOct01svmDistCombined3.rdata"
ls()
rm(list=ls())
file<-"C:/Users/natasa/Documents/projectAmadeus/code/model/taxi/fits/tOct01svmDistCombined3.rdata"
load(file)
file<-"C:/Users/natasa/Documents/projectAmadeus/data/taxi/processed/taxi10_01model.rdata"
load(file)
ls
ls()
str(taxi10_01model)
file<-"C:/Users/natasa/Documents/projectAmadeus/data/taxi/processed/taxiOct01modelDist.rdata"
load(file)
ls()
str(taxiOct01modelDist)
taxi10_01model
str(taxi10_01model)
taxiOct01<-taxi10_01model
str(taxiOct01modelDist)
taxiOct01$distance<-taxiOct01modelDist$dist
taxiOct01$distance<-taxiOct01modelDist$distance
file<-"C:/Users/natasa/Documents/projectAmadeus/code/model/taxi/fits/tOct01DistCombinedSVMdata.rdata"
load(file)
ind<-1:80000
distancePred <- as.vector(predict(svmFitFin,newdata=xtrain[ind,]))
head(xtrain)
distancePred <- as.vector(predict(svmFitFin,newdata=xtrain[ind,]))
distancePred <- as.vector(predict(svmFitFin,newdata=xtrain))
dim(xtrain)
distancePred <- as.vector(predict(svmFitFin,newdata=xtrain))
library(kernlab)
distancePred <- as.vector(predict(svmFitFin,newdata=xtrain))
file<-"C:/Users/natasa/Documents/projectAmadeus/data/taxi/processed/taxiOct01modelDistS.rdata"
load(file)
plot(distancePred,taxiOct01modelDistS$trip_distance_m,xlim=c(0,12000),ylim=c(0,12000),col="black",type="p",pch='.')
abline(a=0,b=1.2,col="red")
lmfit<-lm(taxiOct01modelDistS$trip_distance_m~distancePred)
abline(lmfit,col="blue")
abline(lmfit*1.2,col="yellow")
lmfit
lmfit$a
lmfit$b
lmfit$coeff
lmfit$coeff[1]
lmfit<-lm(taxiOct01modelDistS$trip_distance_m~distancePred)
lmfit
lmfit$coeff[1]
abline(a=lmfit$coeff[1]*1.2,b=lmfit$coeff[2]*1.2,col="yellow")
head(order(taxiOct01modelDist$pickup_datetime))
tail(order(taxiOct01modelDist$pickup_datetime))
taxiOct01model<-taxi10_01model[order(taxiOct01modelDist$pickup_datetime),]
str(taxiOct01model)
head(taxiOct01model)
cutInd<-taxiOct01modelDistS$trip_distance_m > distancePred
sum(cutInd)
cutInd <-taxiOct01modelDistS$trip_distance_m > 1.2*distancePred
sum(cutInd)
taxiOct01modelCut<-taxiOct01model[cutInd,]
head(cutInd)
cutInd <-which(taxiOct01modelDistS$trip_distance_m > 1.2*distancePred)
length(cutInd)
head(cutInd)
taxiOct01modelDistS[8,]
taxiOct01model[8,]
taxi10_01model$distance<-taxiOct01modelDist$distance
taxiOct01model<-taxi10_01model[order(taxiOct01modelDist$pickup_datetime),]
str(taxiOct01model)
head(taxiOct01model)
cutInd <-which(taxiOct01modelDistS$trip_distance_m > 1.2*distancePred)
length(cutInd)
head(cutInd)
# [1] 34600
taxiOct01modelCut<-taxiOct01model[-cutInd,]
taxiOct01model[8,]
taxiOct01model[9,]
plot(taxiOct01model$distance,taxiOct01model$trip_distance_m)
par(mar(2,2,1,1),mfrow(2,1))
?par
par(mar=c(2,2,1,1),mfrow(2,1))
par(mar=c(2,2,1,1),mfrow=c(2,1))
plot(taxiOct01model$distance,taxiOct01model$trip_distance_m,,xlim=c(0,12000),ylim=c(0,12000),col="black",type="p",pch='.')
plot(taxiOct01model$distanceCut,taxiOct01modelCut$trip_distance_m,xlim=c(0,12000),ylim=c(0,12000),col="black",type="p",pch='.')
plot(taxiOct01modelCut$distance,taxiOct01modelCut$trip_distance_m,xlim=c(0,12000),ylim=c(0,12000),col="black",type="p",pch='.')
file<-"C:/Users/natasa/Documents/projectAmadeus/figures/exploratory/taxi/t_dist_tripdist_cut.png"
png(file)
plot(taxiOct01model$distance,taxiOct01model$trip_distance_m,xlim=c(0,12000),ylim=c(0,12000),col="black",type="p",pch='.')
plot(taxiOct01modelCut$distance,taxiOct01modelCut$trip_distance_m,xlim=c(0,12000),ylim=c(0,12000),col="black",type="p",pch='.')
dev.off()
dev.off()
file<-"C:/Users/natasa/Documents/projectAmadeus/figures/exploratory/taxi/t_tripDistPredSVMfin3c.png"
#lmfit<-lm(taxiOct01modelDistS$trip_distance_m~distancePred)
png(file)
plot(distancePred,taxiOct01modelDistS$trip_distance_m,xlim=c(0,12000),ylim=c(0,12000),col="black",type="p",pch='.')
abline(a=0,b=1.2,col="red")
#abline(lmfit,col="blue")
#abline(a=lmfit$coeff[1]*1.2,b=lmfit$coeff[2]*1.2,col="yellow")
dev.off()
file<-"C:/Users/natasa/Documents/projectAmadeus/figures/exploratory/taxi/t_dist_tripdist_cut.png"
png(file)
plot(taxiOct01model$distance,taxiOct01model$trip_distance_m,xlim=c(0,12000),ylim=c(0,12000),col="black",type="p",pch='.')
plot(taxiOct01modelCut$distance,taxiOct01modelCut$trip_distance_m,xlim=c(0,12000),ylim=c(0,12000),col="black",type="p",pch='.')
dev.off()
file<-"C:/Users/natasa/Documents/projectAmadeus/figures/exploratory/taxi/t_dist_tripdist_cut.png"
png(file)
par(mar=c(2,2,1,1),mfrow=c(2,1))
plot(taxiOct01model$distance,taxiOct01model$trip_distance_m,xlim=c(0,12000),ylim=c(0,12000),col="black",type="p",pch='.')
plot(taxiOct01modelCut$distance,taxiOct01modelCut$trip_distance_m,xlim=c(0,12000),ylim=c(0,12000),col="black",type="p",pch='.')
dev.off()
lessInd<-which(taxiOct01model$distance<taxiOct01model$trip_distance_m)
length(lessInd)
lessInd<-which(taxiOct01model$distance>taxiOct01model$trip_distance_m)
length(lessInd)
head(lessInd)
taxiOct01model[12,]
taxiOct01model[44,]
taxiOct01model[46,]
lessInd<-which(taxiOct01model$distance-taxiOct01model$trip_distance_m->500)
lessInd<-which(taxiOct01model$distance-taxiOct01model$trip_distance_m>500)
length(lessind)
length(lessInd)
lessInd<-which(taxiOct01model$distance-taxiOct01model$trip_distance_m>160)
length(lessInd)
lessInd<-which(taxiOct01model$distance-taxiOct01model$trip_distance_m>0)
length(lessInd)
lessInd<-which(taxiOct01model$distance-taxiOct01model$trip_distance_m>100)
length(lessInd)
file<-"C:/Users/natasa/Documents/projectAmadeus/data/taxi/processed/taxiOct01modelDistS.rdata"
load(file)
lessInd<-which(taxiOct01modelDistS$distance>taxiOct01modelDistS$trip_distance_m)
length(lessInd)
file<-"C:/Users/natasa/Documents/projectAmadeus/data/taxi/processed/taxiOct01modelDistS.rdata"
load(file)
lessInd<-which(taxiOct01modelDistS$distance>taxiOct01modelDistS$trip_distance_m)
length(lessInd)
taxiOct01modelDistScut<-taxiOct01modelDistS[-lessInd,]
file<-"C:/Users/natasa/Documents/projectAmadeus/data/taxi/processed/taxiOct01modelDistScut.rdata"
save("taxiOct01modelDistScut",file)
save("taxiOct01modelDistScut",file=file)
library(kernlab)
group<-list()
svmFitList<-list()
k<-10 # no of chunks
d<-dim(taxiOct01modelDistScut)[[1]] # no of observations
no <- floor(d/k) # no of observations per chunk
for (i in 1:k){
cat(i,"\n")
if (i==k) {ind<-((i-1)*no+1):d
} else {ind<-((i-1)*no+1):(i*no)}
xtrain<- as.matrix(taxiOct01modelDistScut[ind,2:5])
trip_distance<- taxiOct01modelDistScut[ind,6]
svmFit<-ksvm(x=xtrain, y=trip_distance,
kernel="rbfdot",kpar="automatic",C=1,epsilon=0.1)
svmPred <- as.vector(predict(svmFit,newdata=taxiOct01modelDistScut[ind,2:5]))
svmFitList[[i]] <- svmFit
group[[i]]<-cbind(svmPred,trip_distance)
}
file<-"C:/Users/natasa/Documents/projectAmadeus/code/model/taxi/fits/tOct01svmDistCut.rdata"
save("svmFitList","group",file=file)
xtrain<-NULL
ind<-1:d
for (i in 1:k){
cat("prediction: chunk",i,"\n")
svmFit <- svmFitList[[i]]
svmPred <- as.vector(predict(svmFit,newdata=taxiOct01modelDistScut[ind,2:5]))
xtrain<-cbind(xtrain,svmPred)
}
str(taxiOct01modelDistS)
rep(0,4)
distance<-rep(0,d)
rm(list=ls())
file<-"C:/Users/natasa/Documents/projectAmadeus/data/taxi/processed/taxi10_01pp_cb.rdata"
load(file)
str(taxi10_01pp_cb)
taxiOct01modelDist<-taxi10_01pp_cb[,c(1,5:9)]
library("Imap")
d<-1:dim(taxi10_01pp_cb)[1]
d
dist<-rep(0,d)
d<-dim(taxi10_01pp_cb)[1]
d
dist<-rep(0,d)
for (i in 1:d){
cat("itearation ",i," ")
dist[i]<-gdist(taxi10_01pp_cb$pickup_longitude[i],taxi10_01pp_cb$pickup_latitude[i],
taxi10_01pp_cb$dropoff_longitude[i],taxi10_01pp_cb$dropoff_latitude[i],
units="m")
}
taxiOct01modelDist$distance<-dist
str(taxiOct01modelDist)
file<-"C:/Users/natasa/Documents/projectAmadeus/data/taxi/processed/taxiOct01modelDist.rdata"
save("taxiOct01modelDist",file=file)
plot(c(1,2,3,4),c(273957, 259559, 252687,244868))
273957-259559
259559-252687
252687-244868
252687 - 249174
7819-3513
library(rpart)
file<-"C:/Users/natasa/Documents/projectAmadeus/data/citibike/processed/cbOct13rbppModelDur.rdata"
load(file=file)
file<-"C:/Users/natasa/Documents/projectAmadeus/data/fits/cbOct13rbppmodelDur.rdata"
load(file=file)
file<-"C:/Users/natasa/Documents/projectAmadeus/data/citibike/processed/t01Oct13cb2ModelDur.rdata"
load(file=file)
file<-"C:/Users/natasa/Documents/projectAmadeus/data/fits/t01Oct13cb2modelDur.rdata"
load(file)
cbDur<-cb_svmPred[,6]
tDur<-tcb_svmPred[,5]
r<-(tDur-cbDur)/tDur
cbfaster<-cbDur-tDur>0
dist<-cbOct13rbppModelDurTest$distance
hour<-cbOct13rbppModelDurTest$startHour
h<-floor(hour)
distf<-cut(dist, c(seq(0,3000,500),max(dist)))
df<-data.frame(cbDur=cbDur,tDur=tDur,r=r,cbfaster=cbfaster,
dist=dist,hour=hour, h=h,distf=distf)
library(rpart)
rpartTreeFit<-rpart(cbfaster ~ dist + hour)
xtest<-data.frame(dist=dist, hour=hour)
rpartTreePred<-predict(xtest)
?predict
rpartTreePred<-predict(rpartTreeFit,newdata=xtest)
table(cfaster,rpartTreePred)
table(cbfaster,rpartTreePred)
head(rpartTreePred)
levels(rpartTreePred)
str(rpartTreePred)
table(cbfaster,rpartTreePred>0.5)
table(cbfaster,rpartTreePred>0.7)
table(cbfaster,rpartTreePred>0.9)
table(cbfaster,rpartTreePred<0.5)
table(cbfaster,rpartTreePred<0.4)
table(cbfaster,rpartTreePred<0.45)
table(cbfaster,rpartTreePred<0.48)
table(cbfaster,rpartTreePred<0.49)
table(cbfaster,rpartTreePred<0.5)
table(cbfaster,rpartTreePred<0.45)
table(cbfaster,rpartTreePred<0.8)
table(cbfaster,rpartTreePred>0.5)
table(cbfaster,rpartTreePred>0.6)
table(cbfaster,rpartTreePred>0.7)
table(cbfaster,rpartTreePred>0.7)/length(cbfaster)
rpartTreePred2<-predict(rpartTreeFit,newdata=xtest, control = rpart.control(cp = 0.005,minsplit=100,maxdepth=30))
table(cbfaster,rpartTreePred>0.65)/length(cbfaster)
table(cbfaster,rpartTreePred>0.6)/length(cbfaster)
table(cbfaster,rpartTreePred>0.5)/length(cbfaster)
table(cbfaster,rpartTreePred>0.55)/length(cbfaster)
table(cbfaster,rpartTreePred>0.56)/length(cbfaster)
table(cbfaster,rpartTreePred>0.6)/length(cbfaster)
table(cbfaster,rpartTreePred>0.65)/length(cbfaster)
table(cbfaster,rpartTreePred>0.7)/length(cbfaster)
rpartTreeFit2<-rpart(cbfaster ~ dist + hour, , control = rpart.control(cp = 0.005,minsplit=100,maxdepth=30))
rpartTreePred2<-predict(rpartTreeFit2,newdata=xtest)
table(cbfaster,rpartTreePred2>0.55)/length(cbfaster)
rpartTreeFit2<-rpart(cbfaster ~ dist + hour, control = rpart.control(cp = 0.005,minsplit=100,maxdepth=60))
rpartTreeFit2<-rpart(cbfaster ~ dist + hour, control = rpart.control(cp = 0.005,minsplit=50,maxdepth=30))
rpartTreePred2<-predict(rpartTreeFit2,newdata=xtest)
table(cbfaster,rpartTreePred2>0.55)/length(cbfaster)
rpartTreeFit2<-rpart(cbfaster ~ dist + hour, control = rpart.control(cp = 0.005,minsplit=20,maxdepth=30))
rpartTreePred2<-predict(rpartTreeFit2,newdata=xtest)
table(cbfaster,rpartTreePred2>0.55)/length(cbfaster)
rpartTreeFit2<-rpart(cbfaster ~ dist + hour, control = rpart.control(cp = 0.001,minsplit=100,maxdepth=30))
rpartTreePred2<-predict(rpartTreeFit2,newdata=xtest)
table(cbfaster,rpartTreePred2>0.55)/length(cbfaster)
rpartTreeFit2<-rpart(cbfaster ~ dist + hour, control = rpart.control(cp = 0.005,minsplit=100,maxdepth=30))
table(cbfaster,rpartTreePred2>0.55)/length(cbfaster)
rpartTreeFit2<-rpart(cbfaster ~ dist + hour, control = rpart.control(cp = 0.005,minsplit=100,maxdepth=30))
rpartTreePred2<-predict(rpartTreeFit2,newdata=xtest)
table(cbfaster,rpartTreePred2>0.55)/length(cbfaster)
ind <- rpartTreePred2>0.55
disthour<-NULL
for (v1 in seq(300,,3000,100)){
for (v2 in seq(300,,3000,100)) disthour<-rbind(disthour,)
}
disthour<-NULL
for (v1 in seq(300,,3000,100)){
for (v2 in seq(300,,3000,100)) disthour<-rbind(disthour,c(v1,v2))
}
ind <- rpartTreePred2>0.55
hourdist<-NULL
for (v1 in seq(0,23.5,0.5)){
for (v2 in seq(300,3000,100)) hourdist<-rbind(hourdist,c(v1,v2))
}
head(hourdist)
colnames(hourdist)<-c("hour","dist")
predict(rpartTreeFit2,newdata=hourdist)
disthour<-data.frame(dist=hourdist[,2],hour=hourdist[,1])
predict(rpartTreeFit2,newdata=disthour)
plot(faster,col='red')
gridPred<-predict(rpartTreeFit2,newdata=disthour)
ind<-gridPred>0.55
faster<-hourdist[ind,]
slower<-hourdist[!ind,]
plot(faster,col='red')
plot(slower,col='blue')
gridPred<-predict(rpartTreeFit2,newdata=disthour)
head(gridPred)
head(disthour)
tail(disthour)
ind<-gridPred>0.55
head(ind)
sum(ind)
sum(!ind)
distHourPred<-data.frame(dist=hourdist[,2],hour=hourdist[,1],faster=ind)
head(distHourPred)
distHourPred<-data.frame(dist=hourdist[,2],hour=hourdist[,1],slower=ind)
head(distHourPred)
ind <- rpartTreePred2>0.55
hourdist<-NULL
for (v1 in seq(0,23.5,0.1)){
for (v2 in seq(300,3000,100)) hourdist<-rbind(hourdist,c(v1,v2))
}
ggplot(distHourPred, aes(hour,dist)) + geom_point(col(aes=slower))
library(ggplot2)
ggplot(distHourPred, aes(hour,dist)) + geom_point(col(aes=slower))
ggplot(distHourPred, aes(hour,dist)) + geom_point(aes(color=slower))
ggplot(distHourPred, aes(hour,dist)) + geom_point(aes(color=slower)) + theme_bw()
distHourPred<-data.frame(dist=hourdist[,2],hour=hourdist[,1],faster=!ind)
distHourPred<-data.frame(dist=hourdist[,2],hour=hourdist[,1],faster=gridPred<0.55)
length(ind)
length(hourdist[,1])
disthour<-data.frame(dist=hourdist[,2],hour=hourdist[,1])
gridPred<-predict(rpartTreeFit2,newdata=disthour)
ind<-gridPred>0.55
distHourPred<-data.frame(dist=hourdist[,2],hour=hourdist[,1],faster=gridPred<0.55)
ggplot(distHourPred, aes(hour,dist)) + geom_point(aes(color=slower)) + theme_bw()
ggplot(distHourPred, aes(hour,dist)) + geom_point(aes(color=faster)) + theme_bw()
distHourPred<-data.frame(dist=hourdist[,2],hour=hourdist[,1],faster=!gridPred<0.55)
ggplot(distHourPred, aes(hour,dist)) + geom_point(aes(color=faster)) + theme_bw()
ind<-gridPred>0.55
head(ind)
ind<-gridPred>0.55
levels(ind)
levels(as.factor(ind))
distHourPred<-data.frame(dist=hourdist[,2],hour=hourdist[,1],citibike_taxi=gridPred>0.55)
indf<-as.factor(ind)
levels(as.factor(ind))<-c("faster","slower")
levels(indf)
head(indf)
levels(indf)<-c("faster","slower")
head(indf)
distHourPred<-data.frame(dist=hourdist[,2],hour=hourdist[,1],citibike_taxi=indf)
distHourPred<-data.frame(dist=hourdist[,2],hour=hourdist[,1],citibike=indf)
ggplot(distHourPred, aes(hour,dist)) +
geom_point(aes(color=citibike_taxi)) + theme_bw()
ggplot(distHourPred, aes(hour,dist)) +
geom_point(aes(color=citibike)) + theme_bw()
plot(dist,r,col="black",type="p",pch='.')
quantile(dist)
quantile(dist,0.05)
quantile(dist,0.1)
ggplot(distHourPred, aes(hour,dist)) +
geom_point(aes(color=citibike)) + theme_bw()
distHourPred<-data.frame(distance=hourdist[,2],hour=hourdist[,1],citibike=indf)
head(distHourPred)
ggplot(distHourPred, aes(hour,distance)) +
geom_point(aes(color=citibike)) + theme_bw()
ggplot(distHourPred, aes(hour,distance)) +
geom_point(aes(color=citibike)) + theme_bw() +
labs(title="Which is faster: citibike or taxi?")
ggplot(distHourPred, aes(hour,distance)) +
geom_point(aes(color=citibike)) + theme_bw() +
labs(title="Which is faster: citibike or taxi?",size=15)
?labs
rpartTreeFit2
plot(rpartTreeFit2)
?rpart
?rpart
rpartTreeFit3<-rpart(cbfaster ~ dist + hour, method="class"
control = rpart.control(cp = 0.005,minsplit=100,maxdepth=30))
rpartTreeFit3<-rpart(cbfaster ~ dist + hour, method="class",
control = rpart.control(cp = 0.005,minsplit=100,maxdepth=30))
rpartTreePred3<-predict(rpartTreeFit3,newdata=xtest)
head(rpartTreeFit3)
head(rpartTreePred3)
head(cbfaster)
cb_svmPred[1,]
t_svmPred[2,]
cbfaster<-cbDur-tDur<0
rpartTreeFit3<-rpart(cbfaster ~ dist + hour, method="class",
control = rpart.control(cp = 0.005,minsplit=100,maxdepth=30))
rpartTreePred3<-predict(rpartTreeFit3,newdata=xtest)
head(rpartTreePred3)
head(cbfaster)
table(cbfaster,rpartTreePred3>0.55)/length(cbfaster)
table(cbfaster,rpartTreePred3[,2]>0.55)/length(cbfaster)
table(cbfaster,rpartTreePred3[,2]>0.6)/length(cbfaster)
table(cbfaster,rpartTreePred3[,2]>0.51)/length(cbfaster)
table(cbfaster,rpartTreePred3[,2]>0.49)/length(cbfaster)
table(cbfaster,rpartTreePred3[,1]<0.49)/length(cbfaster)
table(cbfaster,rpartTreePred3[,1]>0.55)/length(cbfaster)
table(cbfaster,rpartTreePred3[,2]>0.55)/length(cbfaster)
table(cbfaster,rpartTreePred3[,2]>0.7)/length(cbfaster)
table(cbfaster,rpartTreePred3[,2]>0.45)/length(cbfaster)
table(cbfaster,rpartTreePred3[,2]>0.3)/length(cbfaster)
table(cbfaster,rpartTreePred3[,2]>0.35)/length(cbfaster)
rpartTreeFit2<-rpart(cbfaster ~ dist + hour, control = rpart.control(cp = 0.005,minsplit=100,maxdepth=30))
table(cbfaster,rpartTreePred2>0.55)/length(cbfaster)
table(cbfaster,rpartTreePred2<0.55)/length(cbfaster)
table(cbfaster,rpartTreePred3[,2]>=0.55)/length(cbfaster)
table(cbfaster,rpartTreePred3[,2]>=0.55)
rpartTreeFit2<-rpart(cbfaster ~ dist + hour, control = rpart.control(cp = 0.005,minsplit=20,maxdepth=30))
rpartTreeFit3<-rpart(cbfaster ~ dist + hour, method="class",
control = rpart.control(cp = 0.005,minsplit=20,maxdepth=30))
rpartTreePred3<-predict(rpartTreeFit3,newdata=xtest)
table(cbfaster,rpartTreePred3[,2]>=0.55)/length(cbfaster)
control = rpart.control(cp = 0.001,minsplit=20,maxdepth=30))
rpartTreeFit3<-rpart(cbfaster ~ dist + hour, method="class",
control = rpart.control(cp = 0.001,minsplit=20,maxdepth=30))
rpartTreePred3<-predict(rpartTreeFit3,newdata=xtest)
table(cbfaster,rpartTreePred3[,2]>=0.55)/length(cbfaster)
table(cbfaster,rpartTreePred3[,2]>=0.5)/length(cbfaster)
table(cbfaster,rpartTreePred3[,2]>=0.3)/length(cbfaster)
table(cbfaster,rpartTreePred3[,2]>=0.4)/length(cbfaster)
library(ipred)
begging
?begging
??begging
?bagging
baggedTree<-bagging(cbfaster~dist+hour,nbag=1)
baggedTree<-bagging(cbfaster~dist+hour,data=df,nbag=1)
library(radomForest)
install.packages("randomForest")
library(radomForest)
fileu<-paste0(dir,"data/yelp_academic_dataset_user.json")
library("jsonlite")
library("rjson")
library("jsonlite")
dir<-"C:/Users/natasa/Documents/projectYelp/"
fileu<-paste0(dir,"data/yelp_academic_dataset_user.json")
fileuo<-paste0(dir,"data/user.RDS")
user <- stream_in(file(fileu))
library("jsonlite")
#library("rjson")
dir<-"C:/Users/natasa/Documents/projectYelp/"
fileu<-paste0(dir,"data/yelp_academic_dataset_user.json")
fileuo<-paste0(dir,"data/user.RDS")
user <- stream_in(file(fileu))
saveRDS(user, file=fileuo)
review <- stream_in(file(filer))
filer<-paste0(dir,"data/yelp_academic_dataset_review.json")
filero<-paste0(dir,"data/review.RDS")
review <- stream_in(file(filer))
saveRDS(review, file=filero)
dir<-"C:/Users/natasa/Documents/projectYelp/"
filebo<-paste0(dir,"data/business.RDS")
filero<-paste0(dir,"data/review.RDS")
fileto<-paste0(dir,"data/tip.RDS")
fileuo<-paste0(dir,"data/user.RDS")
rm(list=ls())
ls()
dir<-"C:/Users/natasa/Documents/projectYelp/"
filebo<-paste0(dir,"data/business.RDS")
filero<-paste0(dir,"data/review.RDS")
fileto<-paste0(dir,"data/tip.RDS")
fileuo<-paste0(dir,"data/user.RDS")
ls()
business <- readRDS(filebo)
dim(business)
w<-business$attributes$Wi-Fi
w<-business$attributes$"Wi-Fi"
wr<-!is.na(w)
wf<-w[which(w=="free"&!is.na(w)&!is.null(w))]
length(wf)/length(wr)
wr<-w[!is.na(w)]
length(wf)/length(wr)
tip <- readRDS(fileto)
dim(tip)
user <- readRDS(fileuo)
names(user)
user$votes
user$votes[1:3,]
which(user$votes$funny>10000)
names(user)
names(user$compliments)
names(user$compliments$funny)
which(user$compliments$funny>10000)
user[33317,]
user$names
names(user)
names(user$fans)
v1<-user$fans>1 & !is.na(user$fans) & !is.null(user$fans)
v2<-user$compliments$funny>1 & !is.na(user$compliments$funny) & !is.null(user$compliments$funny)
t<-table(v1,v2)
head(t)
?fischer.test
??fischer.test
?fisher.test
fisher.test(t)
library("RCurl", lib.loc="C:/Program Files/R/R-3.1.1/library")
library("rmarkdown", lib.loc="C:/Program Files/R/R-3.1.1/library")
library("RCurl", lib.loc="C:/Program Files/R/R-3.1.1/library")
library("rmarkdown", lib.loc="C:/Program Files/R/R-3.1.1/library")
setwd("~/projectDScapstone/presentation")
